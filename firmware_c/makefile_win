# Makefile for ty71m firmware on windows
projectpath:=%cd%
toolchainpath=$(projectpath)\..\gcc-arm\bin

objfilepath=$(projectpath)\obj
outputpath=$(projectpath)\out

cc:=arm-none-eabi-gcc.exe
objcp:=arm-none-eabi-objcopy.exe

startupFile:=.\startup_NUC122.S

InFiles:=main.c $(startupFile)
elfFile:=.\out\firmware.elf
ccFlags:=-g --specs=nosys.specs -Wall -mcpu=cortex-m0 -mthumb -mfloat-abi=soft -Wextra
ldFlags:=-T.\gcc_arm.ld

firmwareOUT:=.\out\firmware.bin

createBin: 
	@echo "Started compilation of firmware"
	$(cc) -v $(InFiles) $(ldFlags) -I.\inc  -o $(elfFile) $(ccFlags)
	@echo "Finished compilation"
	@echo "ObjCopy"
	$(objcp) -O binary $(elfFile) $(firmwareOUT)
clean:
	@echo "Delete old bin file"
	del /F /Q $(firmwareOUT)